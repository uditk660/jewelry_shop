<div class="invoice-wrapper">

  <!-- ===============================
       PAGE HEADER
  ================================ -->
  <div class="invoice-top">

    <div class="invoice-company">
      <div class="company-name">Sales Register</div>
      <div class="company-details">
        All jewellery sales invoices
      </div>
    </div>

    <div class="invoice-meta actions-right">
      <%= link_to "Sale With Existing", new_sale_path, class: "btn-primary" %>
      <%= link_to "New Sale", new_sale_path, class: "btn-primary" %>
    </div>

  </div>

  <hr>

  <!-- ===============================
       FILTER BAR
  ================================ -->
  <div class="invoice-filter">

    <%= form_tag sales_path, method: :get, class: "filter-form" do %>

      <div class="filter-left">
        <%= text_field_tag :query, params[:query],
              placeholder: "Search Invoice / Amount",
              class: "filter-input" %>

        <%= date_field_tag :from, params[:from], class: "filter-input" %>
        <%= date_field_tag :to, params[:to], class: "filter-input" %>

        <%= submit_tag "Apply", class: "btn-primary small" %>
        <%= link_to "Reset", sales_path, class: "btn-secondary small" %>
      </div>

      <div class="filter-right">
        <%= link_to "Today",
              sales_path(from: Date.today, to: Date.today),
              class: "btn-quick" %>

        <%= link_to "This Month",
              sales_path(from: Date.today.beginning_of_month,
                         to: Date.today.end_of_month),
              class: "btn-quick" %>
      </div>

    <% end %>

  </div>

  <hr>

  <!-- ===============================
       KPI SUMMARY
  ================================ -->
  <div class="invoice-kpis">

    <div class="kpi-box">
      <span>Total Sales</span>
      <strong>₹ <%= number_with_delimiter(@total_sales_amount) %></strong>
    </div>

    <div class="kpi-box">
      <span>Total Bills</span>
      <strong><%= @total_bills %></strong>
    </div>

    <div class="kpi-box">
      <span>Average Bill</span>
      <strong>
        ₹ <%= @total_bills > 0 ? (@total_sales_amount / @total_bills).round(2) : 0 %>
      </strong>
    </div>

  </div>

  <hr>

  <!-- ===============================
       SALES TABLE
  ================================ -->
  <table class="invoice-table">

    <thead>
      <tr>
        <th>Date</th>
        <th>Invoice</th>
        <th class="text-right">Total Amount</th>
        <th class="text-right">Action</th>
      </tr>
    </thead>

    <tbody>
      <% @sales.each do |sale| %>
        <tr>
          <td><%= sale.sale_date.strftime("%d %b %Y") %></td>
          <td>#<%= sale.id %></td>
          <td class="text-right">₹ <%= number_with_delimiter(sale.total_amount) %></td>
          <td class="text-right">
            <%= link_to "View", sale_path(sale), class: "btn-link" %>
          </td>
        </tr>
      <% end %>
    </tbody>

  </table>

</div>
